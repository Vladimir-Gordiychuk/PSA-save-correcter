Общая информация
----------------

Консольная утилита PSA.Saver предназначена для правки сохранений игры Pacific Storm - Allies.

На данный момент позволяет автоматизированно выявлять и править "битые" записи PlayerId,
которые могут возникать в ходе игры в юнитах авиации. Правка записей выполняется в соответствии
с инструкцией, выложенной в комьюнити Samurai Spirit (SS) [см. секцию "Ссылки", №1].

Системные требования
--------------------

Данная консольная утилита построна для платформы .Net Framework 4.0.
Платформа .Net Framework 4.0 поставляется с большинством современных версий Windows.
Если же Ваша версия OC Windows не имеет установленного .Net Framework 4.0,
Вы можете бесплатно скачать дистрибутив с официального сайта Microsoft [ссылка №4].


Использование
-------------

Утилита предназначена для использования через console. Имеет всего один аргумент - путь к распакованному save-файлу.

Утилита модифицирует только распакованные файлы сохранений (т.е. перед её использованием необходимо 
распаковать файл с помощью другой утилиты AttrConv.exe, которую можно найти в инструментарии для модинга [2, 3].

В ходе работы утилита записывает информацию о пропущенных записях в консоль.
Особенно важно контролировать наличие пропущенных записей следующего вида:
"Invalid PlayerId found but no match for 'Airplanes.A6M.Prototype' found in unit map."
В таких случаях необходимо внести соответствующие изменения в файл "unit_map.csv" (например:"A6M",1)
и повторить процедуру. Корректный файл сохранения не должен содержать битых PlayerId.

Пользователь может редактировать соотношение между моделями и PlayerId с помощью файла unit_map.csv,
который должен быть расположен в той же директории, что и исполняемый файл PSA.Saver.
Это особенно важно в тех случаях, когда используются моды (с новыми видами юнитов).

Правила форматирования unit_map.csv файла:
1. формат файла должен соответствовать простым правилам форматирования csv-файлов (coma-separated value):
   избегайте лишних символов (например, пробелов)
   запятая испольуется только как разделитель между столбцами таблицы,
   строковые значения (наименования моделей) должны быть обернуты в кавычки (например, "P40");
2. в качестве ключей таблица должна содержать только наименования моделей.
   Например: для модификации "Airplanes.P40.mod0" необходимо указать только наименования модели, т.е. "P40".

В результате работы утилиты будет создан новый файл, название которого будет аналогично названию
исходного файла с постфиксом "_".

Известные проблемы
------------------

1.	в ходе обработки save-файла изменяется форматирование xml-документа,
	что существенно увеличивает размер файла (+20-30%);
2.	при первой загрузке исправленного сейфа зачастую возникает crash,
	однако повторная попытка загрузки (после перезапуска игры), как правило, срабатывает.

Ссылки
------

1. Samurai Spirit (SS) комьюнити в VK ( https://vk.com/topic-170771562_39028343 )
2. Тема c обсуждениями вспомогательного ПО для PSA ( https://vk.com/topic-170771562_39028264 )
3. Инструментарий для модинга от Samurai Spirit Community ( https://cloud.mail.ru/public/9LcM/DveCWab34 )
4. Ссылка для скачивания .Net Framework 4.0 ( https://www.microsoft.com/ru-ru/download/details.aspx?id=17718 )

Автор
-----

Владимир Гордийчук
Vladimir Gordiychuk ( https://vk.com/vladimir.gordiychuk )
